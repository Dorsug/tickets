{% extends "base.html" %}
{% block styles %}<link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">{% endblock %}
{% block main %}
{% set number_of_pages = range(ceil(len(ateliers) / item_per_pages)) %}
  <div id="pageSelector">
    {% for page_number in number_of_pages %}
    <button class=pageButton onclick=showPage(this) data-pagenumber={{ page_number }}>
      Page {{ page_number + 1 }}
    </button>
    {% endfor %}
  </div>
  {% for page_number in number_of_pages %}
    <div class=page data-pagenumber={{ page_number }}>
    {% for atelier in ateliers[page_number * item_per_pages:(page_number + 1) * item_per_pages] %}
      <div class="temps">
        <div class="horaire_head"></div>
        {% if loop.index is odd and not loop.first %}
          <div class="horaires">
            {% for horaire in horaires %}
              <div class="horaire">
                <span>{{ horaire | ptime }}</span>
              </div>
            {% endfor %}
          </div>
        {% endif %}
      </div>
      <div class="atelier">
        <div class="atelier_head" data-pole="{{ atelier.pole }}" onclick="selectDescription(this)">
          <h3>{{ atelier.nom }}</h3>
        </div>
        <div class="seances" data-atelier="{{ atelier.nom }}">
          {% for horaire in horaires %}
          {% set seance = atelier.seances[date + ' ' + horaire] %}
          {% if seance %}
          <div
            class="seance"
            onclick="ajouterAuPanier(this);"
            data-id="{{ seance.id }}"
            data-horaire="{{ utils.get_naturalDatetime(seance['datetime']) }}"
          >
              {{ seance.placesRestantes }}
            </div>
          {% else %}
            <div class="seance"></div>
          {% endif %}
          {% endfor %}
        </div>
        <div class="description">
          {{ atelier.description }}
        </div>
      </div>
    {% endfor %}
    </div>
  {% endfor %}
{% endblock %}

{% block sidebar %}
  <h3 class="title">Panier</h3>
  <div class="control">
    <div class="control_item" onclick="setNouveauPanier()"><img src="{{ url_for('static', filename='img/plus-circle.svg') }}" /><span class="title">Nouveau</span></div>
    <div class="control_item" onclick="viderPanier()"><img src="{{ url_for('static', filename='img/trash-2.svg') }}" /><span class="title">Supprimer</span></div>
    <div class="control_item" onclick="showPaiement()"><img src="{{ url_for('static', filename='img/dollar-sign.svg') }}" /><span class="title">Paiement</span></div>
    {% if admin %}
    <div class="control_item" onclick="showReserver()"><img src="{{ url_for('static', filename='img/user-check.svg') }}" /><span class="title">Réserver</span></div>
    {% endif %}
  </div>
  <hr />
  <div id="panier">
    <div class="content"></div>
  </div>
{% endblock %}

{% block extra %}
  <div id="paiement" class="finalizePopup">
      <h1>Paiement</h1>
      <form method="post" action="/paiement" onsubmit="paiement()">
          <div>
              Code Postal : <input id="codePostal" name="codePostal" type="number" placeholder="31…" autofocus>
          </div>
          <div>
              <label for="modePaiment">Mode de paiement: </label>
              <label><input type="radio" name="modePaiement" value="0" required checked/>Espèce</label>
              <label><input type="radio" name="modePaiement" value="1" required/>Chèque</label>
          </div>
          <div>
              <input type="submit" value="Ok">
          </div>
      </form>
      <button onclick="hidePaiement()">Fermer</button>
  </div>

  <div id="reserver" class="finalizePopup">
      <h1>Réserver</h1>
      <form method="post" action="/reserver">
          <div>
            <label for="nom">Nom: </label><input type=text name="nom" required/>
            <label for="prenom">Prénom: </label><input type=text name="prenom" required/>
            <label for="email">E-Mail: </label><input type=email name="email" required/>
          <div>
              Code Postal : <input id="codePostal" name="codePostal" type="number" placeholder="31…">
          </div>
          <div>
              <label for="modePaiment">Mode de paiement: </label>
              <label><input type="radio" name="modePaiement" value="0" required checked/>Espèce</label>
              <label><input type="radio" name="modePaiement" value="1" required/>Chèque</label>
          </div>
          <div>
              <input type="submit" value="Ok">
          </div>
      </form>
      <button onclick="hideReserver()">Fermer</button>
  </div>
{% endblock %}
